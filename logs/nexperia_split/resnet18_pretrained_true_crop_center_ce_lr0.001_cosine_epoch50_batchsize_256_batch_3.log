Namespace(arch='resnet18', base_width=64, batch_size=256, ce_momentum=0, crop='center', data_root='/home/kaiyihuang/nexperia/batch_3/all', dataset='nexperia_split', el1=None, el10=None, el2=None, el3=None, el4=None, el5=None, el6=None, el7=None, el8=None, el9=None, epochs=50, evaluate=False, feature_extraction=False, loss='ce', lr=0.001, lr_gamma=0.1, lr_milestones=[40, 80], lr_schedule='cosine', mod=None, momentum=0.9, noise_info=None, noise_rate=0.02, noise_type='corrupted_label', optimizer='sgd', pretrained=True, print_freq=200, resume='', sat_alpha=0.9, sat_es=150, sat_es1=None, sat_es10=None, sat_es2=None, sat_es3=None, sat_es4=None, sat_es5=None, sat_es6=None, sat_es7=None, sat_es8=None, sat_es9=None, save_dir='ckpts/nexperia_split/resnet18_pretrained_true_crop_center_ce_lr0.001_cosine_epoch50_batchsize_256_batch_3', save_freq=0, seed=1406, start_epoch=0, train_sets='trainval', turn_off_aug=False, use_refined_label=False, val_sets=['test_set'], weight_decay=0.0005, workers=4)
Using `SGD` optimizer
Using `cosine` schedule
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:123: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [1][200/479]	LR 0.001000	Time 0.426 (0.447)	Data 0.021 (0.032)	Loss 0.1482 (0.2650)	Prec@1 95.312 (94.004)	Binary Loss 0.0945 (0.1904)	Binary Accuracy 95.312 (93.918)	Margin Error 0.8858 (0.8647)	Binary Margin Error 0.8782 (0.8484)
Epoch: [1][400/479]	LR 0.001000	Time 0.417 (0.430)	Data 0.020 (0.028)	Loss 0.0865 (0.1949)	Prec@1 95.703 (95.168)	Binary Loss 0.0663 (0.1347)	Binary Accuracy 96.484 (95.366)	Margin Error 0.9125 (0.8829)	Binary Margin Error 0.9105 (0.8741)
Epoch: [1][479/479]	LR 0.001000	Time 2.703 (0.432)	Data 0.017 (0.027)	Loss 0.0939 (0.1802)	Prec@1 97.279 (95.396)	Binary Loss 0.0460 (0.1230)	Binary Accuracy 99.320 (95.707)	Margin Error 0.9236 (0.8878)	Binary Margin Error 0.9305 (0.8809)
Epoch: [1]	AUC: 91.99%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 93.95%, 95.64%, 96.66%, 98.05%, 99.87%
****************************************
val:
Epoch: [1]	Loss 0.1377	Prec@1 96.42%	Binary Loss 0.0989	Binary Accuracy 96.58%	Margin Error 0.9217	Binary Margin Error 0.9243	AUC: 98.60%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 12.44%, 12.93%, 21.37%, 22.60%, 39.95%
****************************************
test:
Epoch: [1]	Loss 0.1392	Prec@1 96.34%	Binary Loss 0.1009	Binary Accuracy 96.48%	Margin Error 0.9221	Binary Margin Error 0.9247	AUC: 98.66%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 14.12%, 15.56%, 23.77%, 27.43%, 49.29%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [2][200/479]	LR 0.000999	Time 0.412 (0.426)	Data 0.020 (0.029)	Loss 0.1088 (0.0960)	Prec@1 96.875 (97.035)	Binary Loss 0.0747 (0.0557)	Binary Accuracy 97.656 (97.881)	Margin Error 0.9176 (0.9215)	Binary Margin Error 0.9222 (0.9264)
Epoch: [2][400/479]	LR 0.000999	Time 0.413 (0.421)	Data 0.020 (0.026)	Loss 0.0866 (0.0877)	Prec@1 96.875 (97.325)	Binary Loss 0.0439 (0.0496)	Binary Accuracy 97.656 (98.142)	Margin Error 0.9314 (0.9278)	Binary Margin Error 0.9384 (0.9342)
Epoch: [2][479/479]	LR 0.000999	Time 0.255 (0.420)	Data 0.021 (0.025)	Loss 0.0478 (0.0853)	Prec@1 97.959 (97.407)	Binary Loss 0.0361 (0.0477)	Binary Accuracy 98.639 (98.215)	Margin Error 0.9533 (0.9301)	Binary Margin Error 0.9560 (0.9369)
Epoch: [2]	AUC: 99.27%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 9.10%, 10.91%, 14.20%, 16.71%, 50.27%
****************************************
val:
Epoch: [2]	Loss 0.1123	Prec@1 96.53%	Binary Loss 0.0770	Binary Accuracy 97.11%	Margin Error 0.9314	Binary Margin Error 0.9374	AUC: 99.41%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 7.56%, 8.31%, 11.55%, 13.29%, 24.74%
****************************************
test:
Epoch: [2]	Loss 0.1101	Prec@1 96.40%	Binary Loss 0.0755	Binary Accuracy 96.87%	Margin Error 0.9312	Binary Margin Error 0.9370	AUC: 99.46%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 8.99%, 11.64%, 14.19%, 17.83%, 26.63%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [3][200/479]	LR 0.000996	Time 0.420 (0.428)	Data 0.023 (0.032)	Loss 0.0813 (0.0709)	Prec@1 98.047 (97.836)	Binary Loss 0.0283 (0.0368)	Binary Accuracy 98.828 (98.656)	Margin Error 0.9502 (0.9425)	Binary Margin Error 0.9664 (0.9527)
Epoch: [3][400/479]	LR 0.000996	Time 0.417 (0.424)	Data 0.021 (0.027)	Loss 0.0342 (0.0680)	Prec@1 99.219 (97.912)	Binary Loss 0.0267 (0.0340)	Binary Accuracy 99.219 (98.777)	Margin Error 0.9592 (0.9450)	Binary Margin Error 0.9606 (0.9563)
Epoch: [3][479/479]	LR 0.000996	Time 0.254 (0.423)	Data 0.021 (0.026)	Loss 0.0745 (0.0685)	Prec@1 97.279 (97.897)	Binary Loss 0.0438 (0.0341)	Binary Accuracy 98.639 (98.784)	Margin Error 0.9468 (0.9451)	Binary Margin Error 0.9596 (0.9567)
Epoch: [3]	AUC: 99.60%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 5.00%, 5.52%, 7.17%, 9.77%, 91.03%
****************************************
val:
Epoch: [3]	Loss 0.1318	Prec@1 96.16%	Binary Loss 0.0974	Binary Accuracy 96.58%	Margin Error 0.9271	Binary Margin Error 0.9323	AUC: 99.60%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 5.90%, 6.06%, 9.02%, 9.16%, 15.46%
****************************************
test:
Epoch: [3]	Loss 0.1303	Prec@1 96.01%	Binary Loss 0.0967	Binary Accuracy 96.39%	Margin Error 0.9257	Binary Margin Error 0.9309	AUC: 99.66%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 5.06%, 6.45%, 8.14%, 9.00%, 22.30%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [4][200/479]	LR 0.000991	Time 0.418 (0.424)	Data 0.021 (0.029)	Loss 0.0767 (0.0645)	Prec@1 97.656 (97.904)	Binary Loss 0.0240 (0.0306)	Binary Accuracy 99.219 (98.877)	Margin Error 0.9448 (0.9490)	Binary Margin Error 0.9730 (0.9619)
Epoch: [4][400/479]	LR 0.000991	Time 0.412 (0.421)	Data 0.022 (0.026)	Loss 0.0349 (0.0617)	Prec@1 99.219 (98.035)	Binary Loss 0.0162 (0.0291)	Binary Accuracy 99.609 (98.946)	Margin Error 0.9687 (0.9510)	Binary Margin Error 0.9752 (0.9639)
Epoch: [4][479/479]	LR 0.000991	Time 0.247 (0.420)	Data 0.017 (0.025)	Loss 0.0583 (0.0615)	Prec@1 97.279 (98.029)	Binary Loss 0.0215 (0.0287)	Binary Accuracy 98.639 (98.956)	Margin Error 0.9448 (0.9511)	Binary Margin Error 0.9683 (0.9644)
Epoch: [4]	AUC: 99.72%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 3.52%, 4.01%, 4.78%, 6.72%, 45.35%
****************************************
val:
Epoch: [4]	Loss 0.1079	Prec@1 96.57%	Binary Loss 0.0751	Binary Accuracy 97.17%	Margin Error 0.9339	Binary Margin Error 0.9422	AUC: 99.69%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 3.63%, 6.27%, 8.91%, 10.76%, 14.09%
****************************************
test:
Epoch: [4]	Loss 0.1062	Prec@1 96.55%	Binary Loss 0.0742	Binary Accuracy 97.17%	Margin Error 0.9338	Binary Margin Error 0.9419	AUC: 99.70%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 3.35%, 3.61%, 6.45%, 7.93%, 27.83%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [5][200/479]	LR 0.000984	Time 0.426 (0.428)	Data 0.027 (0.031)	Loss 0.0221 (0.0575)	Prec@1 99.609 (98.078)	Binary Loss 0.0099 (0.0257)	Binary Accuracy 99.219 (99.062)	Margin Error 0.9785 (0.9543)	Binary Margin Error 0.9853 (0.9684)
Epoch: [5][400/479]	LR 0.000984	Time 0.418 (0.424)	Data 0.022 (0.027)	Loss 0.0730 (0.0571)	Prec@1 97.656 (98.106)	Binary Loss 0.0289 (0.0257)	Binary Accuracy 99.219 (99.050)	Margin Error 0.9490 (0.9547)	Binary Margin Error 0.9678 (0.9687)
Epoch: [5][479/479]	LR 0.000984	Time 0.249 (0.423)	Data 0.018 (0.027)	Loss 0.0298 (0.0566)	Prec@1 99.320 (98.128)	Binary Loss 0.0093 (0.0253)	Binary Accuracy 100.000 (99.065)	Margin Error 0.9808 (0.9550)	Binary Margin Error 0.9834 (0.9690)
Epoch: [5]	AUC: 99.77%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 2.26%, 2.65%, 3.16%, 4.73%, 37.72%
****************************************
val:
Epoch: [5]	Loss 0.0987	Prec@1 96.93%	Binary Loss 0.0669	Binary Accuracy 97.58%	Margin Error 0.9391	Binary Margin Error 0.9482	AUC: 99.75%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 3.57%, 5.95%, 7.09%, 8.43%, 12.00%
****************************************
test:
Epoch: [5]	Loss 0.0960	Prec@1 96.92%	Binary Loss 0.0652	Binary Accuracy 97.53%	Margin Error 0.9395	Binary Margin Error 0.9482	AUC: 99.78%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 2.66%, 3.11%, 4.29%, 4.31%, 11.63%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [6][200/479]	LR 0.000976	Time 0.416 (0.426)	Data 0.022 (0.030)	Loss 0.0221 (0.0546)	Prec@1 99.219 (98.176)	Binary Loss 0.0101 (0.0237)	Binary Accuracy 99.609 (99.100)	Margin Error 0.9795 (0.9568)	Binary Margin Error 0.9831 (0.9712)
Epoch: [6][400/479]	LR 0.000976	Time 0.413 (0.422)	Data 0.021 (0.026)	Loss 0.0225 (0.0530)	Prec@1 99.219 (98.248)	Binary Loss 0.0173 (0.0230)	Binary Accuracy 99.219 (99.126)	Margin Error 0.9776 (0.9577)	Binary Margin Error 0.9796 (0.9719)
Epoch: [6][479/479]	LR 0.000976	Time 0.249 (0.421)	Data 0.018 (0.025)	Loss 0.0783 (0.0525)	Prec@1 97.279 (98.273)	Binary Loss 0.0268 (0.0226)	Binary Accuracy 99.320 (99.149)	Margin Error 0.9459 (0.9582)	Binary Margin Error 0.9722 (0.9724)
Epoch: [6]	AUC: 99.83%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 1.98%, 2.19%, 2.69%, 3.79%, 19.91%
****************************************
val:
Epoch: [6]	Loss 0.0960	Prec@1 96.94%	Binary Loss 0.0659	Binary Accuracy 97.62%	Margin Error 0.9409	Binary Margin Error 0.9501	AUC: 99.76%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 3.69%, 5.27%, 6.83%, 7.54%, 10.85%
****************************************
test:
Epoch: [6]	Loss 0.0930	Prec@1 97.07%	Binary Loss 0.0636	Binary Accuracy 97.66%	Margin Error 0.9410	Binary Margin Error 0.9501	AUC: 99.81%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 2.25%, 2.70%, 3.02%, 3.76%, 12.45%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [7][200/479]	LR 0.000965	Time 0.423 (0.430)	Data 0.023 (0.032)	Loss 0.0889 (0.0496)	Prec@1 97.266 (98.412)	Binary Loss 0.0493 (0.0208)	Binary Accuracy 98.047 (99.244)	Margin Error 0.9409 (0.9606)	Binary Margin Error 0.9580 (0.9749)
Epoch: [7][400/479]	LR 0.000965	Time 0.411 (0.424)	Data 0.021 (0.027)	Loss 0.0840 (0.0485)	Prec@1 97.266 (98.438)	Binary Loss 0.0265 (0.0207)	Binary Accuracy 98.438 (99.258)	Margin Error 0.9442 (0.9613)	Binary Margin Error 0.9679 (0.9754)
Epoch: [7][479/479]	LR 0.000965	Time 0.259 (0.422)	Data 0.025 (0.026)	Loss 0.0238 (0.0485)	Prec@1 98.639 (98.424)	Binary Loss 0.0149 (0.0205)	Binary Accuracy 99.320 (99.258)	Margin Error 0.9766 (0.9613)	Binary Margin Error 0.9794 (0.9755)
Epoch: [7]	AUC: 99.85%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 1.49%, 1.98%, 2.45%, 3.54%, 49.07%
****************************************
val:
Epoch: [7]	Loss 0.0855	Prec@1 97.24%	Binary Loss 0.0568	Binary Accuracy 97.85%	Margin Error 0.9445	Binary Margin Error 0.9544	AUC: 99.80%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 2.82%, 4.81%, 5.54%, 6.08%, 10.01%
****************************************
test:
Epoch: [7]	Loss 0.0828	Prec@1 97.32%	Binary Loss 0.0545	Binary Accuracy 97.96%	Margin Error 0.9445	Binary Margin Error 0.9547	AUC: 99.83%	FPR(=99.1%, 99.3%, 99.5%, 99.7%, 100%): 1.75%, 2.30%, 3.15%, 3.41%, 7.82%
****************************************
/home/kaiyihuang/.conda/envs/tensorflow2_pytorch/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:143: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: [8][200/479]	LR 0.000952	Time 0.416 (0.431)	Data 0.023 (0.032)	Loss 0.1078 (0.0451)	Prec@1 96.875 (98.566)	Binary Loss 0.0561 (0.0190)	Binary Accuracy 98.047 (99.328)	Margin Error 0.9286 (0.9631)	Binary Margin Error 0.9491 (0.9768)
Epoch: [8][400/479]	LR 0.000952	Time 0.422 (0.425)	Data 0.023 (0.027)	Loss 0.0149 (0.0454)	Prec@1 99.609 (98.558)	Binary Loss 0.0069 (0.0189)	Binary Accuracy 99.609 (99.336)	Margin Error 0.9801 (0.9633)	Binary Margin Error 0.9881 (0.9774)
